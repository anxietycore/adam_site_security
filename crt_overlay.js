(()=>{const e=Math.min(window.devicePixelRatio||1,2),t=document.getElementById("terminalCanvas");if(!t)return;const n=document.createElement("canvas");n.id="crtOverlayCanvas",Object.assign(n.style,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%",zIndex:1e3,pointerEvents:"none"}),document.body.appendChild(n);const r=n.getContext("webgl",{antialias:!1});if(!r)return;function i(){n.width=Math.floor(window.innerWidth*e),n.height=Math.floor(window.innerHeight*e),n.style.width=window.innerWidth+"px",n.style.height=window.innerHeight+"px",r.viewport(0,0,n.width,n.height)}window.addEventListener("resize",i),i();function a(e,t){const n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS),n}const o=r.createProgram();r.attachShader(o,a("\n    attribute vec2 aPos;\n    attribute vec2 aUV;\n    varying vec2 vUV;\n    void main(){ vUV = aUV; gl_Position = vec4(aPos,0.0,1.0); }\n  ",r.VERTEX_SHADER)),r.attachShader(o,a("\n    precision mediump float;\n    varying vec2 vUV;\n    uniform sampler2D uTex;\n    uniform float uDist;\n    void main(){\n      vec2 uv = vUV * 2.0 - 1.0;\n      float r = length(uv);\n      vec2 d = mix(uv, uv * r, uDist);\n      vec2 f = (d + 1.0) * 0.5;\n      f.y = 1.0 - f.y; // match canvas orientation\n      vec4 c = texture2D(uTex, clamp(f, 0.0, 1.0));\n      gl_FragColor = c;\n    }\n  ",r.FRAGMENT_SHADER)),r.linkProgram(o),r.getProgramParameter(o,r.LINK_STATUS),r.useProgram(o);const c=new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),E=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,E),r.bufferData(r.ARRAY_BUFFER,c,r.STATIC_DRAW);const T=r.getAttribLocation(o,"aPos"),d=r.getAttribLocation(o,"aUV");r.enableVertexAttribArray(T),r.enableVertexAttribArray(d),r.vertexAttribPointer(T,2,r.FLOAT,!1,16,0),r.vertexAttribPointer(d,2,r.FLOAT,!1,16,8);const s=r.createTexture();r.bindTexture(r.TEXTURE_2D,s),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR);const A=r.getUniformLocation(o,"uDist");r.uniform1f(A,.2);let m=0;requestAnimationFrame((function e(n){m||(m=n),n-m>=33.333333333333336&&(m=n,function(){try{r.bindTexture(r.TEXTURE_2D,s),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)}catch(e){}}(),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.drawArrays(r.TRIANGLE_STRIP,0,4)),requestAnimationFrame(e)})),window.__CRTOverlay={setDistortion(e){A&&r.uniform1f(A,e)},destroy(){n.remove()}}})();
